<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CERS.Observer.ExpenditureDateTypewiselistPage"
             xmlns:ios="clr-namespace:Microsoft.Maui.Controls.PlatformConfiguration.iOSSpecific;assembly=Microsoft.Maui.Controls"            
             ios:Page.UseSafeArea="true">

    <NavigationPage.TitleView  >
        <StackLayout  Orientation="Horizontal" HorizontalOptions="FillAndExpand" VerticalOptions="CenterAndExpand" >
            <Image Source="seclogo.png"  HeightRequest="40"  VerticalOptions="CenterAndExpand"/>
            <StackLayout  Orientation="Vertical" VerticalOptions="CenterAndExpand" HorizontalOptions="CenterAndExpand" Spacing="0">
                <Label x:Name="lbl_title" Text="State Election Commission, H.P." Style="{StaticResource NavigationLabelColor}" FontSize="20" FontAttributes="Bold" HorizontalTextAlignment="Center" VerticalTextAlignment="Center" />
            </StackLayout>
        </StackLayout>
    </NavigationPage.TitleView>

    <ContentPage.ToolbarItems>
        <ToolbarItem IconImageSource="refresh.png" Clicked="ToolbarItem_Clicked"  Text="Refresh"/>
    </ContentPage.ToolbarItems>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <StackLayout Margin="9" Grid.Row="0">
            <StackLayout VerticalOptions="FillAndExpand">
                <Label x:Name="lbl_heading" FontSize="18" BackgroundColor="Navy" TextColor="White" FontAttributes="Bold" HorizontalOptions="FillAndExpand" HorizontalTextAlignment="Center"/>
                <Frame VerticalOptions="FillAndExpand" HasShadow="False" CornerRadius="20" BackgroundColor="White" BorderColor="#07a6db" Margin="0,10,0,0">

                    <StackLayout>
                        <Label x:Name="lbl_heading1" FontSize="18" HorizontalOptions="CenterAndExpand" FontAttributes="Bold" TextColor="Navy" TextDecorations="Underline"/>
                        <StackLayout Orientation="Horizontal" HorizontalOptions="StartAndExpand" BackgroundColor="Transparent">
                            <Label x:Name="lbl_Type" FontSize="16" HorizontalOptions="FillAndExpand" TextColor="Navy"  FontAttributes="Bold"  VerticalOptions="Center"/>
                            <RadioButton FontSize="16" x:Name="rb_exptype" IsChecked="true" GroupName="expgroup" TextColor="Black" BackgroundColor="Transparent" CheckedChanged="rb_exp_CheckedChanged"/>
                            <RadioButton FontSize="16" x:Name="rb_expdate" IsChecked="False" GroupName="expgroup" TextColor="Black" BackgroundColor="Transparent" CheckedChanged="rb_exp_CheckedChanged"/>
                        </StackLayout>
                        <Label IsVisible="false" x:Name="lbl_norecords" FontSize="16" FontAttributes="Bold" TextColor="Red" HorizontalOptions="Center"/>
                        <Label  IsVisible="false" x:Name="lbl_totalamount" FontSize="16" FontAttributes="Bold" TextColor="Navy" HorizontalOptions="Center"/>

                        <Grid VerticalOptions="FillAndExpand">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Grid x:Name="grid_data" Margin="4" Grid.Row="0" >
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="auto"/>
                                    <RowDefinition Height="auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="7.5*"/>
                                    <ColumnDefinition Width="2.5*"/>
                                </Grid.ColumnDefinitions>
                                <Label VerticalOptions="Center" FontSize="16" x:Name="lblexptype"   HorizontalOptions="StartAndExpand" TextColor="Navy"  Grid.Column="0" FontAttributes="Bold" />
                                <Label VerticalOptions="Center"  FontSize="16" x:Name="lblAmount" HorizontalOptions="EndAndExpand" TextColor="Navy"    Grid.Column="1" FontAttributes="Bold"  />
                            </Grid>

                            <ListView x:Name="listView_expendituredetailstypewise" HasUnevenRows="True" VerticalOptions="FillAndExpand" SeparatorColor="Transparent"  SelectionMode="None" Grid.Row="1" ItemTapped="listView_expendituredetailstypewise_ItemTapped">
                                <ListView.ItemTemplate >
                                    <DataTemplate>
                                        <ViewCell Appearing="ViewCell_Appearing">
                                            <StackLayout Margin="4" >
                                                <Grid RowSpacing="5" >
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="auto"/>
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="8*"/>
                                                        <ColumnDefinition Width="2*"/>
                                                    </Grid.ColumnDefinitions>

                                                    <Label VerticalOptions="Center"  HorizontalOptions="StartAndExpand"  FontSize="16" Text="{Binding displaytitle}"   TextColor="Navy"  Grid.Column="0"/>
                                                    <Label  VerticalOptions="Center"  HorizontalOptions="EndAndExpand"  FontSize="16"  Text="{Binding amount}" TextColor="Navy"   Grid.Column="1" />

                                                </Grid>
                                            </StackLayout>
                                        </ViewCell>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>

                            <Label Grid.Row="2" Margin="0,10,0,5" Padding="0" x:Name="lbl_tapfooter" HorizontalOptions="Center" FontAttributes="Bold" FontSize="14" TextColor="Navy"/>
                        </Grid>
                      
                    </StackLayout>
                </Frame>

                <Label  Margin="0" Padding="0" x:Name="lbl_lastupdated" FontAttributes="Bold" HorizontalOptions="Center" FontSize="14" HorizontalTextAlignment="Center"/>
            </StackLayout>
        </StackLayout>

        <!-- Footer moved to proper Grid row -->
        <Grid Grid.Row="1" Style="{StaticResource FooterGridStyle}" >
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackLayout Orientation="Vertical" HorizontalOptions="FillAndExpand" Grid.Row="0" Grid.Column="0">
                <StackLayout.GestureRecognizers>
                    <TapGestureRecognizer Tapped="Tab_Home_Tapped"/>
                </StackLayout.GestureRecognizers>
                <Image x:Name="Tab_Home_Image" Source="ic_homewhite.png" HeightRequest="20"/>
                <Label x:Name="Tab_Home_Label" Text="Home" Style="{StaticResource LabelStyle_TabMenu}"/>
            </StackLayout>

            <StackLayout IsVisible="false" Orientation="Vertical" HorizontalOptions="FillAndExpand" Grid.Row="0" Grid.Column="1">
                <StackLayout.GestureRecognizers>
                    <TapGestureRecognizer Tapped="Tab_New_Tapped"/>
                </StackLayout.GestureRecognizers>
                <Image x:Name="Tab_New_Image" Source="ic_addwhite.png" HeightRequest="20"/>
                <Label x:Name="Tab_New_Label" Text="Add Expenses" Style="{StaticResource LabelStyle_TabMenu}"/>
            </StackLayout>

            <StackLayout Orientation="Vertical" HorizontalOptions="FillAndExpand" Grid.Row="0" Grid.Column="2" >
                <StackLayout.GestureRecognizers>
                    <TapGestureRecognizer Tapped="Tab_Settings_Tapped"/>
                </StackLayout.GestureRecognizers>
                <Image x:Name="Tab_Settings_Image" Source="ic_morewhite.png" HeightRequest="20"/>
                <Label x:Name="Tab_Settings_Label" Text="More" Style="{StaticResource LabelStyle_TabMenu}"/>
            </StackLayout>
        </Grid>

        <Grid x:Name="Loading_activity" 
              BackgroundColor="#C0808080" 
              IsVisible="false"
              ZIndex="1000"
              Grid.RowSpan="2">
            <Border BackgroundColor="White" 
                    StrokeThickness="0"
                    Padding="20"
                    HorizontalOptions="Center"
                    VerticalOptions="Center">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="10"/>
                </Border.StrokeShape>
                <HorizontalStackLayout Spacing="10">
                    <ActivityIndicator IsVisible="true" IsRunning="true" Color="Navy" IsEnabled="True"/>
                    <Label x:Name="lbl_PleaseWait" 
                           Text="Please Wait ..." 
                           TextColor="Black" 
                           FontAttributes="Bold" 
                           VerticalOptions="Center"/>
                </HorizontalStackLayout>
            </Border>
        </Grid>
    </Grid>
</ContentPage>